import e from"postcss-selector-parser";var t;function r(e,r,n,a,s=!1){if(r.startsWith("__proto__")||null!=n&&n.startsWith("__proto__"))return[];let u=!1;n||""===n||(u=!0);let o="";u||(o=n.toString()),s&&(o=o.toLowerCase());return e.filter((e=>{let n="";if(n="variable"===r.toLowerCase()&&"decl"===e.type&&"variable"in e?"variable":Object.keys(e).find((t=>t.toLowerCase()===r.toLowerCase()&&Object.prototype.hasOwnProperty.call(e,t))),!n)return!1;if("boolean"==typeof e[n])return e[n];if(u)return!0;let i=[e[n].toString()];switch("rule"!==e.type||"selector"!==n&&"selectors"!==n||(i=e.selectors),s&&(i=i.map((e=>e.toLowerCase()))),a){case t.StartsWith:return!!i.find((e=>e.startsWith(o)));case t.EndsWith:return!!i.find((e=>e.endsWith(o)));case t.Contains:return!!i.find((e=>e.includes(o)));case t.Exact:default:return!!i.find((e=>e===o))}}))}function n(e){switch(e.type){case"decl":{const t=e;return a({type:t.type,important:t.important,prop:t.prop,value:t.value,variable:t.variable})}case"rule":{const t=e;return a({type:t.type,selectors:t.selectors})}case"atrule":{const t=e;return a({type:t.type,name:t.name,params:t.params})}case"comment":{const t=e;return a({type:t.type,text:t.text})}default:return{}}}function a(e){return Object.keys(e).forEach((t=>{void 0===e[t]&&delete e[t]})),e}function s(e,t){const r={};for(const[a,s]of t){let t=new Set;s.each((r=>{t=u(e,r,t)})),r[a]=[];for(const e of t)r[a].push(n(e))}return r}function u(e,t,r){const n=o(t),a=new Set(r);return e.walk((e=>{if(a.has(e))return;i(n,[e]).length>0&&a.add(e)})),a}function o(e){if(!e||!e.nodes)return;let n=null;return e.each((e=>{switch(e.type){case"universal":n={next:n,run:e=>e};break;case"combinator":switch(e.value){case" ":n={next:n,run:e=>function(e){return e.flatMap((t=>{const r=[];let n=t.parent;for(;n;)r.push(n),n=n.parent;return e.length?r:[]})).filter((e=>!!e))}(e)};break;case">":n={next:n,run:e=>function(e){return e.map((e=>e.parent)).filter((e=>!!e))}(e)};break;case"+":n={next:n,run:e=>function(e){return e.map((e=>e.prev())).filter((e=>!!e))}(e)};break;case"~":n={next:n,run:e=>function(e){return e.flatMap((t=>{const r=[];let n=t.prev();for(;n;)r.push(n),n=n.prev();return e.length?r:[]})).filter((e=>!!e))}(e)};break;default:n={next:n,run:()=>[]}}break;case"tag":n={next:n,run:t=>function(e,t){return e.filter((e=>e.type.toLowerCase()===t.toLowerCase()))}(t,e.value)};break;case"pseudo":if(":not"===e.value)n={next:n,run:t=>{const r=e.nodes.map((e=>o(e))),n=t.filter((e=>r.flatMap((t=>i(t,[e]))).length>0));return function(e,t){return e.filter((e=>!t.includes(e)))}(t,n)}};else n={next:n,run:()=>[]};break;case"attribute":switch(e.operator){case"^=":n={next:n,run:n=>r(n,e.attribute,e.value,t.StartsWith,e.insensitive)};break;case"$=":n={next:n,run:n=>r(n,e.attribute,e.value,t.EndsWith,e.insensitive)};break;case"*=":n={next:n,run:n=>r(n,e.attribute,e.value,t.Contains,e.insensitive)};break;default:n={next:n,run:n=>r(n,e.attribute,e.value,t.Exact,e.insensitive)}}break;default:n={next:n,run:()=>[]}}})),n}function i(e,t){let r=e,n=t;for(;r&&n.length>0;)n=r.run(n),r=r.next;return n}!function(e){e.Exact="",e.StartsWith="^",e.EndsWith="$",e.Contains="*"}(t||(t={}));const c=t=>{var r;const n=Object(t),a=new Map;return Object.keys(null!=(r=n.queries)?r:{}).forEach((t=>{a.set(t,e().astSync(n.queries[t]))})),n.results||(n.results=e=>{console.log(e)}),{postcssPlugin:"postcss-extract",prepare:()=>t.extractLate?{OnceExit:e=>{n.results(s(e,a))}}:{Once:e=>{n.results(s(e,a))}}}};c.postcss=!0;export{c as default};
