"use strict";var e=require("@csstools/css-tokenizer");const r=/(?:license|copyright)/i,n=/sourceMappingURL/i,o=/(?:[\s]|\/\*)/;function minify(r){if(!r||!o.test(r))return r;if(""===r.trim())return" ";const n=e.tokenize({css:r});for(let r=0;r<n.length;r++){const o=n[r];if(o[0]===e.TokenType.Comment||o[0]===e.TokenType.Whitespace){o[1]=" ";let t=n[r+1];for(;t&&(t[0]===e.TokenType.Comment||t[0]===e.TokenType.Whitespace);)t[1]="",r++,t=n[r+1]}}return e.stringify(...n)}function removeEmptyNodes(e){var r;if("rule"===e.type){if(0===(null==(r=e.nodes)?void 0:r.length)){var n;const r=e.parent;return e.remove(),0===(null==r||null==(n=r.nodes)?void 0:n.length)&&removeEmptyNodes(r),!0}}else if("atrule"===e.type){var o;if(0===(null==(o=e.nodes)?void 0:o.length)&&"layer"!==e.name.toLowerCase()){var t;const r=e.parent;return e.remove(),0===(null==r||null==(t=r.nodes)?void 0:t.length)&&removeEmptyNodes(r),!0}}return!1}const creator=()=>({postcssPlugin:"postcss-minify",OnceExit(e){e.raws={before:"",after:"\n"},e.walk((e=>{if("comment"!==e.type)if("decl"===e.type&&e.variable){var o;e.raws={...e.raws,before:minify(null==(o=e.raws)?void 0:o.before)}}else{if("atrule"===e.type){var t,i,s,l,a;if(removeEmptyNodes(e))return;return e.raws={before:minify(null==(t=e.raws)?void 0:t.before),after:minify(null==(i=e.raws)?void 0:i.after),between:minify(null==(s=e.raws)?void 0:s.between),semicolons:null==(l=e.raws)?void 0:l.semicolons,afterName:minify(null==(a=e.raws)?void 0:a.afterName)},void(e.params=minify(e.params))}if("rule"===e.type){var f,m,u,v;if(removeEmptyNodes(e))return;return e.raws={before:minify(null==(f=e.raws)?void 0:f.before),after:minify(null==(m=e.raws)?void 0:m.after),between:minify(null==(u=e.raws)?void 0:u.between),semicolons:null==(v=e.raws)?void 0:v.semicolons},void(e.selector=minify(e.selector))}var y,c;if("decl"===e.type)e.raws={before:minify(null==(y=e.raws)?void 0:y.before),between:":",semicolons:null==(c=e.raws)?void 0:c.semicolons,important:e.important?"!important":""},e.value=minify(e.value)}else{if(r.test(e.text)||n.test(e.text))return;e.remove()}}))}});creator.postcss=!0,module.exports=creator;
