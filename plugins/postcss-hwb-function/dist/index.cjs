"use strict";var e=require("@csstools/css-color-parser"),s=require("@csstools/utilities"),t=require("@csstools/css-parser-algorithms"),r=require("@csstools/css-tokenizer");const o="(color: hwb(0 0% 0%))";function hasSupportsAtRuleAncestor(e){let s=e.parent;for(;s;)if("atrule"===s.type){if("supports"===s.name.toLowerCase()&&s.params.includes(o))return!0;s=s.parent}else s=s.parent;return!1}const a=/hwb\(/i,n=/^hwb$/i,postcssPlugin=l=>{const c="preserve"in Object(l)&&Boolean(l?.preserve);return{postcssPlugin:"postcss-hwb-function",Declaration:(l,{postcss:p})=>{const i=l.value;if(!a.test(i))return;if(c&&hasSupportsAtRuleAncestor(l))return;if(s.hasFallback(l))return;const u=t.replaceComponentValues(t.parseCommaSeparatedListOfComponentValues(r.tokenize({css:i})),(s=>{if(!t.isFunctionNode(s)||!n.test(s.getName()))return;const r=e.color(s);return r&&!(r.syntaxFlags.has(e.SyntaxFlag.Experimental)||r.syntaxFlags.has(e.SyntaxFlag.HasNoneKeywords)||r.syntaxFlags.has(e.SyntaxFlag.RelativeColorSyntax))?e.serializeRGB(r):void 0})),f=t.stringify(u);if(f!==i)if(l.variable&&c&&l.parent){const e=l.parent,s=p.atRule({name:"supports",params:o,source:l.source}),t=e.clone();t.removeAll(),t.append(l.clone()),s.append(t),insertAtSupportsAfterCorrectRule(s,e,o),l.replaceWith(l.clone({value:f}))}else c?l.cloneBefore({value:f}):l.replaceWith(l.clone({value:f}))}}};function insertAtSupportsAfterCorrectRule(e,s,t){let r=s,o=s.next();for(;r&&o&&"atrule"===o.type&&"supports"===o.name.toLowerCase()&&o.params===t;)r=o,o=o.next();r.after(e)}postcssPlugin.postcss=!0,module.exports=postcssPlugin;
