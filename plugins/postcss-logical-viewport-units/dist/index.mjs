import{hasFallback as t,hasSupportsAtRuleAncestor as o}from"@csstools/utilities";import{tokenizer as e,TokenType as i,stringify as n}from"@csstools/css-tokenizer";var r;function transform(t,o){const r=e({css:t}),s=[];let c=!1;for(;;){const t=r.nextToken();if(!t)break;if(s.push(t),t[0]===i.EOF)break;if(t[0]!==i.Dimension)continue;const e=t[4].unit.toLowerCase();let n;"vi"===e?n=o.vi:"vb"===e&&(n=o.vb),n&&(t[1]=t[4].value.toString()+n,t[4].unit=n,c=!0)}return c?n(...s):t}!function(t){t.TopToBottom="top-to-bottom",t.BottomToTop="bottom-to-top",t.RightToLeft="right-to-left",t.LeftToRight="left-to-right"}(r||(r={}));const s={test(t){{const o=t.toLowerCase();if(!o.includes("vb")&&!o.includes("vi"))return!1}const o=e({css:t});for(;;){const t=o.nextToken();if(!t)break;if(t[0]===i.EOF)break;if(t[0]!==i.Dimension)continue;const e=t[4].unit.toLowerCase();if("vb"===e||"vi"===e)return!0}return!1}},c=/(?:vi|vb)\b/i,creator=e=>{const i=Object.assign({inlineDirection:r.LeftToRight,preserve:!0},e);switch(i.inlineDirection){case r.LeftToRight:case r.RightToLeft:case r.TopToBottom:case r.BottomToTop:break;default:throw new Error(`[postcss-logical-viewport-units] "inlineDirection" must be one of ${Object.values(r).join(", ")}`)}const n=[r.LeftToRight,r.RightToLeft].includes(i.inlineDirection),u={vb:"vh",vi:"vw"};return n||(u.vb="vw",u.vi="vh"),{postcssPlugin:"postcss-logical-viewport-units",Declaration(e,{atRule:n}){if(!c.test(e.value))return;if(t(e))return;if(o(e,s))return;const r=transform(e.value,u);if(r===e.value)return;if(e.cloneBefore({value:r}),!i.preserve)return void e.remove();if(!e.variable)return;const a=n({name:"supports",params:"(top: 1vi)",source:e.source}),f=e.parent;if(!f)return;const v=f.cloneAfter({nodes:[]});v.append(e),a.append(v),f.after(a)}}};creator.postcss=!0;export{creator as default};
