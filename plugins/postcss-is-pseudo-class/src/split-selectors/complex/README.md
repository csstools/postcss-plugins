Some patterns can be detected and converted.
This is very difficult to abstract, so best to handle this case by case on request.

Make each case a separate file and write a very specific matcher.
