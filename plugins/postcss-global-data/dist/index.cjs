"use strict";var e=require("path"),r=require("fs");function parseImport(s,t,a){let o="";if(t.startsWith("node_modules://"))try{o=require.resolve(t.slice(15),{paths:[e.dirname(t)]})}catch(e){throw new Error(`Failed to read ${t} with error ${e.message}`)}else o=e.resolve(t);if(a.has(o))return!1;a.add(o);const n=r.readFileSync(o,"utf8");return s.parse(n,{from:t})}const creator=e=>{const r=Object.assign({files:[]},e);return{postcssPlugin:"postcss-global-data",prepare(){let e=new Set,s=new Set;return{Once:(t,{postcss:a})=>{r.files.forEach((r=>{if(e.has(r))return;const o=parseImport(a,r,e);o&&o.each((e=>{t.append(e),s.add(e)}))}))},OnceExit:()=>{s.forEach((e=>{e.remove()})),s=new Set,e=new Set}}}}};creator.postcss=!0,module.exports=creator;
