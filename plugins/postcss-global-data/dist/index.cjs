"use strict";var e=require("path"),r=require("fs");function parseImport(s,t,a,n){var o,l;let i="";if(a.startsWith("node_modules://"))try{i=require.resolve(a.slice(15),{paths:[e.dirname(a)]})}catch(e){throw new Error(`Failed to read ${a} with error ${e.message}`)}else i=e.resolve(a);if(n.has(i))return!1;n.add(i),t.result.messages.push({type:"dependency",plugin:"postcss-global-data",file:i,parent:null==(o=s.source)||null==(l=o.input)?void 0:l.file});const c=r.readFileSync(i,"utf8");return t.postcss.parse(c,{from:i})}const creator=e=>{const r=Object.assign({files:[]},e);return{postcssPlugin:"postcss-global-data",prepare(){let e=new Set,s=new Set;return{Once:(t,a)=>{r.files.forEach((r=>{if(e.has(r))return;const n=parseImport(t,a,r,e);n&&n.each((e=>{t.append(e),s.add(e)}))}))},OnceExit:()=>{s.forEach((e=>{e.remove()})),s=new Set,e=new Set}}}}};creator.postcss=!0,module.exports=creator;
