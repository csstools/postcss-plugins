import{isWhitespaceNode as e,isCommentNode as t,isTokenNode as r,isFunctionNode as n}from"@csstools/css-parser-algorithms";import{TokenType as u,NumberType as o}from"@csstools/css-tokenizer";import{calcFromComponentValues as a}from"@csstools/css-calc";import{xyz as l}from"@csstools/color-helpers";var i;function rgb(e){{const t=rgbCommaSeparated(e);if(-1!==t)return t}{const t=rgbSpaceSeparated(e);if(-1!==t)return t}return-1}function rgbCommaSeparated(c){const s=[],f=[],v=[],g=[];let m=s;for(let l=0;l<c.value.length;l++){let i=c.value[l];if(!e(i)&&!t(i)){if(r(i)&&i.value[0]===u.Comma){if(m===s){m=f;continue}if(m===f){m=v;continue}if(m===v){m=g;continue}if(m===g)return-1}if(n(i)){if("calc"!==i.getName().toLowerCase())return-1;const[[e]]=a([[i]],{toCanonicalUnits:!0,precision:100});if(!e||!r(e))return-1;i=e}if(r(i)){let e=255;if(m===g&&(e=1),i.value[0]===u.Percentage){const e=i.value;m.push([u.Number,(e[4].value/100).toString(),e[2],e[3],{value:e[4].value/100,type:o.Number}]);continue}if(i.value[0]===u.Number){const t=i.value;m.push([u.Number,(t[4].value/e).toString(),t[2],t[3],{value:t[4].value/e,type:o.Number}]);continue}}return-1}}if(1!==m.length)return-1;if(1!==s.length||1!==f.length||1!==v.length)return-1;return{channels:l.sRGB_to_XYZ_D50([s[0][4].value,f[0][4].value,v[0][4].value]),alpha:1===g.length?g[0][4].value:1,currentColorSpace:i.XYZ_D50,sourceColorSpace:i.sRGB}}function rgbSpaceSeparated(c){const s=[],f=[],v=[],g=[];let m=s;for(let l=0;l<c.value.length;l++){let i=c.value[l];if(e(i)||t(i)){for(;e(c.value[l+1])||t(c.value[l+1]);)l++;if(m===s){m=f;continue}if(m===f){m=v;continue}}else{if(!r(i)||i.value[0]!==u.Delim||"/"!==i.value[4].value){if(n(i)){if("calc"!==i.getName().toLowerCase())return-1;const[[e]]=a([[i]],{toCanonicalUnits:!0,precision:100});if(!e||!r(e))return-1;i=e}if(r(i)){let e=255;if(m===g&&(e=1),i.value[0]===u.Percentage){const e=i.value;m.push([u.Number,(e[4].value/100).toString(),e[2],e[3],{value:e[4].value/100,type:o.Number}]);continue}if(i.value[0]===u.Number){const t=i.value;m.push([u.Number,(t[4].value/e).toString(),t[2],t[3],{value:t[4].value/e,type:o.Number}]);continue}}return-1}if(m===g)return-1;m=g}}if(1!==m.length)return-1;if(1!==s.length||1!==f.length||1!==v.length)return-1;return{channels:l.sRGB_to_XYZ_D50([s[0][4].value,f[0][4].value,v[0][4].value]),alpha:1===g.length?g[0][4].value:1,currentColorSpace:i.XYZ_D50,sourceColorSpace:i.sRGB}}function color(e){if(n(e))return"rgb"===e.getName().toLowerCase()||"rgba"===e.getName().toLowerCase()?rgb(e):void 0}!function(e){e.XYZ_D50="xyz-d50",e.XYZ_D65="xyz-d65",e.sRGB="srgb"}(i||(i={}));export{i as ColorSpace,color};
