"use strict";class ParseError extends Error{sourceStart;sourceEnd;parserState;constructor(e,r,o,n){super(e),this.name="ParseError",this.sourceStart=r,this.sourceEnd=o,this.parserState=n}}class Reader{cursor;source="";codePointSource=[];length=0;representationStart=0;representationEnd=-1;constructor(e){this.cursor=0,this.source=e,this.length=e.length,this.codePointSource=new Array(this.length);for(let e=0;e<this.length;e++)this.codePointSource[e]=this.source.charCodeAt(e)}advanceCodePoint(e=1){this.cursor+=e,this.representationEnd=this.cursor-1}readCodePoint(e=1){const r=this.codePointSource[this.cursor];return void 0!==r&&(this.cursor+=e,this.representationEnd=this.cursor-1,r)}unreadCodePoint(e=1){return 0!==this.cursor&&(this.cursor-=e,this.representationEnd=this.cursor-1,!0)}}var e,r,o;exports.TokenType=void 0,(e=exports.TokenType||(exports.TokenType={})).Comment="comment",e.AtKeyword="at-keyword-token",e.BadString="bad-string-token",e.BadURL="bad-url-token",e.CDC="CDC-token",e.CDO="CDO-token",e.Colon="colon-token",e.Comma="comma-token",e.Delim="delim-token",e.Dimension="dimension-token",e.EOF="EOF-token",e.Function="function-token",e.Hash="hash-token",e.Ident="ident-token",e.Number="number-token",e.Percentage="percentage-token",e.Semicolon="semicolon-token",e.String="string-token",e.URL="url-token",e.Whitespace="whitespace-token",e.OpenParen="(-token",e.CloseParen=")-token",e.OpenSquare="[-token",e.CloseSquare="]-token",e.OpenCurly="{-token",e.CloseCurly="}-token",exports.NumberType=void 0,(r=exports.NumberType||(exports.NumberType={})).Integer="integer",r.Number="number",function(e){e.Unrestricted="unrestricted",e.ID="id"}(o||(o={}));const n=45,t=65533;function checkIfFourCodePointsWouldStartCDO(e,r){return 60===r.codePointSource[r.cursor]&&33===r.codePointSource[r.cursor+1]&&r.codePointSource[r.cursor+2]===n&&r.codePointSource[r.cursor+3]===n}function isDigitCodePoint(e){return e>=48&&e<=57}function isUppercaseLetterCodePoint(e){return e>=65&&e<=90}function isLowercaseLetterCodePoint(e){return e>=97&&e<=122}function isHexDigitCodePoint(e){return isDigitCodePoint(e)||e>=97&&e<=102||e>=65&&e<=70}function isLetterCodePoint(e){return isLowercaseLetterCodePoint(e)||isUppercaseLetterCodePoint(e)}function isNonASCIICodePoint(e){return e>=128}function isIdentStartCodePoint(e){return isLetterCodePoint(e)||isNonASCIICodePoint(e)||95===e}function isIdentCodePoint(e){return isIdentStartCodePoint(e)||isDigitCodePoint(e)||e===n}function isNewLine(e){return 10===e||13===e||12===e}function isWhitespace(e){return 32===e||10===e||9===e||13===e||12===e}function checkIfTwoCodePointsAreAValidEscape(e,r){return 92===r.codePointSource[r.cursor]&&!isNewLine(r.codePointSource[r.cursor+1])}function checkIfThreeCodePointsWouldStartAnIdentSequence(e,r){return r.codePointSource[r.cursor]===n?r.codePointSource[r.cursor+1]===n||(!!isIdentStartCodePoint(r.codePointSource[r.cursor+1])||92===r.codePointSource[r.cursor+1]&&10!==r.codePointSource[r.cursor+2]):!!isIdentStartCodePoint(r.codePointSource[r.cursor])||checkIfTwoCodePointsAreAValidEscape(0,r)}function checkIfThreeCodePointsWouldStartANumber(e,r){return 43===r.codePointSource[r.cursor]||r.codePointSource[r.cursor]===n?!!isDigitCodePoint(r.codePointSource[r.cursor+1])||46===r.codePointSource[r.cursor+1]&&isDigitCodePoint(r.codePointSource[r.cursor+2]):46===r.codePointSource[r.cursor]?isDigitCodePoint(r.codePointSource[r.cursor+1]):isDigitCodePoint(r.codePointSource[r.cursor])}function checkIfTwoCodePointsStartAComment(e,r){return 47===r.codePointSource[r.cursor]&&42===r.codePointSource[r.cursor+1]}function checkIfThreeCodePointsWouldStartCDC(e,r){return r.codePointSource[r.cursor]===n&&r.codePointSource[r.cursor+1]===n&&62===r.codePointSource[r.cursor+2]}function consumeComment(e,r){for(r.advanceCodePoint(2);;){const o=r.readCodePoint();if(!1===o){e.onParseError(new ParseError("Unexpected EOF while consuming a comment.",r.representationStart,r.representationEnd,["4.3.2. Consume comments","Unexpected EOF"]));break}if(42===o&&(void 0!==r.codePointSource[r.cursor]&&47===r.codePointSource[r.cursor])){r.advanceCodePoint();break}}return[exports.TokenType.Comment,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,void 0]}function consumeEscapedCodePoint(e,r){const o=r.readCodePoint();if(!1===o)return e.onParseError(new ParseError("Unexpected EOF while consuming an escaped code point.",r.representationStart,r.representationEnd,["4.3.7. Consume an escaped code point","Unexpected EOF"])),t;if(isHexDigitCodePoint(o)){const e=[o];for(;void 0!==r.codePointSource[r.cursor]&&isHexDigitCodePoint(r.codePointSource[r.cursor])&&e.length<6;)e.push(r.codePointSource[r.cursor]),r.advanceCodePoint();isWhitespace(r.codePointSource[r.cursor])&&r.advanceCodePoint();const i=parseInt(String.fromCharCode(...e),16);return 0===i?t:(n=i)>=55296&&n<=57343||i>1114111?t:i}var n;return o}function consumeIdentSequence(e,r){const o=[];for(;;)if(isIdentCodePoint(r.codePointSource[r.cursor]))o.push(r.codePointSource[r.cursor]),r.advanceCodePoint();else{if(!checkIfTwoCodePointsAreAValidEscape(0,r))return o;r.advanceCodePoint(),o.push(consumeEscapedCodePoint(e,r))}}function consumeHashToken(e,r){if(r.advanceCodePoint(),void 0!==r.codePointSource[r.cursor]&&(isIdentCodePoint(r.codePointSource[r.cursor])||checkIfTwoCodePointsAreAValidEscape(0,r))){let n=o.Unrestricted;checkIfThreeCodePointsWouldStartAnIdentSequence(0,r)&&(n=o.ID);const t=consumeIdentSequence(e,r);return[exports.TokenType.Hash,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:String.fromCharCode(...t),type:n}]}return[exports.TokenType.Delim,"#",r.representationStart,r.representationEnd,{value:"#"}]}function consumeNumber(e,r){let o=exports.NumberType.Integer;for(43!==r.codePointSource[r.cursor]&&r.codePointSource[r.cursor]!==n||r.advanceCodePoint();isDigitCodePoint(r.codePointSource[r.cursor]);)r.advanceCodePoint();if(46===r.codePointSource[r.cursor]&&isDigitCodePoint(r.codePointSource[r.cursor+1]))for(r.advanceCodePoint(2),o=exports.NumberType.Number;isDigitCodePoint(r.codePointSource[r.cursor]);)r.advanceCodePoint();if(101===r.codePointSource[r.cursor]||69===r.codePointSource[r.cursor]){if(isDigitCodePoint(r.codePointSource[r.cursor+1]))r.advanceCodePoint(2);else{if(r.codePointSource[r.cursor+1]!==n&&43!==r.codePointSource[r.cursor+1]||!isDigitCodePoint(r.codePointSource[r.cursor+2]))return o;r.advanceCodePoint(3)}for(o=exports.NumberType.Number;isDigitCodePoint(r.codePointSource[r.cursor]);)r.advanceCodePoint()}return o}function consumeNumericToken(e,r){const o=consumeNumber(0,r),n=parseFloat(r.source.slice(r.representationStart,r.representationEnd+1));if(checkIfThreeCodePointsWouldStartAnIdentSequence(0,r)){const t=consumeIdentSequence(e,r);return[exports.TokenType.Dimension,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:n,type:o,unit:String.fromCharCode(...t)}]}return 37===r.codePointSource[r.cursor]?(r.advanceCodePoint(),[exports.TokenType.Percentage,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:n}]):[exports.TokenType.Number,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:n,type:o}]}function consumeWhiteSpace(e,r){for(;isWhitespace(r.codePointSource[r.cursor]);)r.advanceCodePoint();return[exports.TokenType.Whitespace,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,void 0]}function consumeStringToken(e,r){let o="";const n=r.readCodePoint();for(;;){const t=r.readCodePoint();if(!1===t)return e.onParseError(new ParseError("Unexpected EOF while consuming a string token.",r.representationStart,r.representationEnd,["4.3.5. Consume a string token","Unexpected EOF"])),[exports.TokenType.String,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:o}];if(isNewLine(t))return e.onParseError(new ParseError("Unexpected newline while consuming a string token.",r.representationStart,r.representationEnd,["4.3.5. Consume a string token","Unexpected newline"])),r.unreadCodePoint(),[exports.TokenType.BadString,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,void 0];if(t===n)return[exports.TokenType.String,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:o}];if(92!==t)o+=String.fromCharCode(t);else{if(void 0===r.codePointSource[r.cursor])continue;if(isNewLine(r.codePointSource[r.cursor])){r.advanceCodePoint();continue}o+=String.fromCharCode(consumeEscapedCodePoint(e,r))}}}const i="u".charCodeAt(0),s="U".charCodeAt(0),c="r".charCodeAt(0),a="R".charCodeAt(0),u="l".charCodeAt(0),d="L".charCodeAt(0);function checkIfCodePointsMatchURLIdent(e,r){return 3===r.length&&((r[0]===i||r[0]===s)&&((r[1]===c||r[1]===a)&&(r[2]===u||r[2]===d)))}function consumeBadURL(e,r){for(;;){if(void 0===r.codePointSource[r.cursor])return;if(41===r.codePointSource[r.cursor])return void r.advanceCodePoint();checkIfTwoCodePointsAreAValidEscape(0,r)?(r.advanceCodePoint(),consumeEscapedCodePoint(e,r)):r.advanceCodePoint()}}function consumeUrlToken(e,r){consumeWhiteSpace(0,r);let o="";for(;;){if(void 0===r.codePointSource[r.cursor])return e.onParseError(new ParseError("Unexpected EOF while consuming a url token.",r.representationStart,r.representationEnd,["4.3.6. Consume a url token","Unexpected EOF"])),[exports.TokenType.URL,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:o}];if(41===r.codePointSource[r.cursor])return r.advanceCodePoint(),[exports.TokenType.URL,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:o}];if(isWhitespace(r.codePointSource[r.cursor]))return consumeWhiteSpace(0,r),void 0===r.codePointSource[r.cursor]?(e.onParseError(new ParseError("Unexpected EOF while consuming a url token.",r.representationStart,r.representationEnd,["4.3.6. Consume a url token","Consume as much whitespace as possible","Unexpected EOF"])),[exports.TokenType.URL,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:o}]):41===r.codePointSource[r.cursor]?(r.advanceCodePoint(),[exports.TokenType.URL,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:o}]):(consumeBadURL(e,r),[exports.TokenType.BadURL,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,void 0]);if(34===r.codePointSource[r.cursor]||39===r.codePointSource[r.cursor]||40===r.codePointSource[r.cursor]||(11===(n=r.codePointSource[r.cursor])||127===n||0<=n&&n<=8||14<=n&&n<=31))return consumeBadURL(e,r),e.onParseError(new ParseError("Unexpected character while consuming a url token.",r.representationStart,r.representationEnd,["4.3.6. Consume a url token","Unexpected U+0022 QUOTATION MARK (\"), U+0027 APOSTROPHE ('), U+0028 LEFT PARENTHESIS (() or non-printable code point"])),[exports.TokenType.BadURL,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,void 0];if(92===r.codePointSource[r.cursor]){if(checkIfTwoCodePointsAreAValidEscape(0,r)){r.advanceCodePoint(),o+=String.fromCharCode(consumeEscapedCodePoint(e,r));continue}return consumeBadURL(e,r),e.onParseError(new ParseError("Invalid escape sequence while consuming a url token.",r.representationStart,r.representationEnd,["4.3.6. Consume a url token","U+005C REVERSE SOLIDUS (\\)","The input stream does not start with a valid escape sequence"])),[exports.TokenType.BadURL,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,void 0]}o+=String.fromCharCode(r.codePointSource[r.cursor]),r.advanceCodePoint()}var n}function consumeIdentLikeToken(e,r){const o=consumeIdentSequence(e,r);if(40!==r.codePointSource[r.cursor])return[exports.TokenType.Ident,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:String.fromCharCode(...o)}];if(checkIfCodePointsMatchURLIdent(0,o)){r.advanceCodePoint();let n=0;for(;;){const e=isWhitespace(r.codePointSource[r.cursor]),t=isWhitespace(r.codePointSource[r.cursor+1]);if(e&&t){n+=1,r.advanceCodePoint(1);continue}const i=e?r.codePointSource[r.cursor+1]:r.codePointSource[r.cursor];if(34===i||39===i)return n>0&&r.unreadCodePoint(n),[exports.TokenType.Function,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:String.fromCharCode(...o)}];break}return consumeUrlToken(e,r)}return r.advanceCodePoint(),[exports.TokenType.Function,r.source.slice(r.representationStart,r.representationEnd+1),r.representationStart,r.representationEnd,{value:String.fromCharCode(...o)}]}exports.ParseError=ParseError,exports.Reader=Reader,exports.cloneTokens=function cloneTokens(e){return"undefined"!=typeof globalThis&&"structuredClone"in globalThis?structuredClone(e):JSON.parse(JSON.stringify(e))},exports.isToken=function isToken(e){return!!Array.isArray(e)&&(!(e.length<4)&&(e[0]in exports.TokenType&&("string"==typeof e[1]&&("number"==typeof e[2]&&"number"==typeof e[3]))))},exports.mirrorVariant=function mirrorVariant(e){switch(e[0]){case exports.TokenType.OpenParen:return[exports.TokenType.CloseParen,")",-1,-1,void 0];case exports.TokenType.CloseParen:return[exports.TokenType.OpenParen,"(",-1,-1,void 0];case exports.TokenType.OpenCurly:return[exports.TokenType.CloseCurly,"}",-1,-1,void 0];case exports.TokenType.CloseCurly:return[exports.TokenType.OpenCurly,"{",-1,-1,void 0];case exports.TokenType.OpenSquare:return[exports.TokenType.CloseSquare,"]",-1,-1,void 0];case exports.TokenType.CloseSquare:return[exports.TokenType.OpenSquare,"[",-1,-1,void 0];default:return null}},exports.mirrorVariantType=function mirrorVariantType(e){switch(e){case exports.TokenType.OpenParen:return exports.TokenType.CloseParen;case exports.TokenType.CloseParen:return exports.TokenType.OpenParen;case exports.TokenType.OpenCurly:return exports.TokenType.CloseCurly;case exports.TokenType.CloseCurly:return exports.TokenType.OpenCurly;case exports.TokenType.OpenSquare:return exports.TokenType.CloseSquare;case exports.TokenType.CloseSquare:return exports.TokenType.OpenSquare;default:return null}},exports.mutateIdent=function mutateIdent(e,r){let o="";const t=new Array(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);let i=0;t[0]===n&&t[1]===n?(o="--",i=2):t[0]===n&&t[1]?(o="-",i=2,isIdentStartCodePoint(t[1])?o+=r[1]:o+=`\\${t[1].toString(16)} `):isIdentStartCodePoint(t[0])?(o=r[0],i=1):(o=`\\${t[0].toString(16)} `,i=1);for(let e=i;e<t.length;e++)isIdentCodePoint(t[e])?o+=r[e]:o+=`\\${t[e].toString(16)} `;e[1]=o,e[4].value=r},exports.stringify=function stringify(...e){let r="";for(let o=0;o<e.length;o++)r+=e[o][1];return r},exports.tokenizer=function tokenizer(e,r){const o=e.css.valueOf(),t=new Reader(o),i={onParseError:(null==r?void 0:r.onParseError)??(()=>{})};return{nextToken:function nextToken(){if(t.representationStart=t.cursor,t.representationEnd=-1,checkIfTwoCodePointsStartAComment(0,t))return consumeComment(i,t);const e=t.codePointSource[t.cursor];if(void 0===e)return[exports.TokenType.EOF,"",-1,-1,void 0];if(isIdentStartCodePoint(e))return consumeIdentLikeToken(i,t);if(isDigitCodePoint(e))return consumeNumericToken(i,t);switch(e){case 44:return t.advanceCodePoint(),[exports.TokenType.Comma,",",t.representationStart,t.representationEnd,void 0];case 58:return t.advanceCodePoint(),[exports.TokenType.Colon,":",t.representationStart,t.representationEnd,void 0];case 59:return t.advanceCodePoint(),[exports.TokenType.Semicolon,";",t.representationStart,t.representationEnd,void 0];case 40:return t.advanceCodePoint(),[exports.TokenType.OpenParen,"(",t.representationStart,t.representationEnd,void 0];case 41:return t.advanceCodePoint(),[exports.TokenType.CloseParen,")",t.representationStart,t.representationEnd,void 0];case 91:return t.advanceCodePoint(),[exports.TokenType.OpenSquare,"[",t.representationStart,t.representationEnd,void 0];case 93:return t.advanceCodePoint(),[exports.TokenType.CloseSquare,"]",t.representationStart,t.representationEnd,void 0];case 123:return t.advanceCodePoint(),[exports.TokenType.OpenCurly,"{",t.representationStart,t.representationEnd,void 0];case 125:return t.advanceCodePoint(),[exports.TokenType.CloseCurly,"}",t.representationStart,t.representationEnd,void 0];case 39:case 34:return consumeStringToken(i,t);case 35:return consumeHashToken(i,t);case 43:case 46:return checkIfThreeCodePointsWouldStartANumber(0,t)?consumeNumericToken(i,t):(t.advanceCodePoint(),[exports.TokenType.Delim,t.source[t.representationStart],t.representationStart,t.representationEnd,{value:t.source[t.representationStart]}]);case 10:case 13:case 12:case 9:case 32:return consumeWhiteSpace(0,t);case n:return checkIfThreeCodePointsWouldStartANumber(0,t)?consumeNumericToken(i,t):checkIfThreeCodePointsWouldStartCDC(0,t)?(t.advanceCodePoint(3),[exports.TokenType.CDC,"--\x3e",t.representationStart,t.representationEnd,void 0]):checkIfThreeCodePointsWouldStartAnIdentSequence(0,t)?consumeIdentLikeToken(i,t):(t.advanceCodePoint(),[exports.TokenType.Delim,"-",t.representationStart,t.representationEnd,{value:"-"}]);case 60:return checkIfFourCodePointsWouldStartCDO(0,t)?(t.advanceCodePoint(4),[exports.TokenType.CDO,"\x3c!--",t.representationStart,t.representationEnd,void 0]):(t.advanceCodePoint(),[exports.TokenType.Delim,"<",t.representationStart,t.representationEnd,{value:"<"}]);case 64:if(t.advanceCodePoint(),checkIfThreeCodePointsWouldStartAnIdentSequence(0,t)){const e=consumeIdentSequence(i,t);return[exports.TokenType.AtKeyword,t.source.slice(t.representationStart,t.representationEnd+1),t.representationStart,t.representationEnd,{value:String.fromCharCode(...e)}]}return[exports.TokenType.Delim,"@",t.representationStart,t.representationEnd,{value:"@"}];case 92:return checkIfTwoCodePointsAreAValidEscape(0,t)?consumeIdentLikeToken(i,t):(t.advanceCodePoint(),i.onParseError(new ParseError('Invalid escape sequence after "\\"',t.representationStart,t.representationEnd,["4.3.1. Consume a token","U+005C REVERSE SOLIDUS (\\)","The input stream does not start with a valid escape sequence"])),[exports.TokenType.Delim,"\\",t.representationStart,t.representationEnd,{value:"\\"}])}return t.advanceCodePoint(),[exports.TokenType.Delim,t.source[t.representationStart],t.representationStart,t.representationEnd,{value:t.source[t.representationStart]}]},endOfFile:function endOfFile(){return void 0===t.codePointSource[t.cursor]}}};
