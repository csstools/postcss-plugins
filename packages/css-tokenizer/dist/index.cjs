"use strict";class Reader{cursor;source="";codePointSource=[];length=0;representationStart=0;representationEnd=-1;constructor(e){this.cursor=0,this.source=e,this.length=e.length,this.codePointSource=[];for(let o=0;o<e.length;o++)this.codePointSource.push(e.charCodeAt(o))}cursorPositionOfLastReadCodePoint(){return this.cursor-1}advanceCodePoint(e=1){this.cursor+=e,this.representationEnd=this.cursor-1}readCodePoint(e=1){const o=this.codePointSource[this.cursor];return void 0!==o&&(this.cursor+=e,this.representationEnd=this.cursor-1,o)}unreadCodePoint(e=1){return 0!==this.cursor&&(this.cursor-=e,this.representationEnd=this.cursor-1,!0)}}var e,o,t;exports.TokenType=void 0,(e=exports.TokenType||(exports.TokenType={})).Comment="comment",e.AtKeyword="at-keyword-token",e.BadString="bad-string-token",e.BadURL="bad-url-token",e.CDC="CDC-token",e.CDO="CDO-token",e.Colon="colon-token",e.Comma="comma-token",e.Delim="delim-token",e.Dimension="dimension-token",e.EOF="EOF-token",e.Function="function-token",e.Hash="hash-token",e.Ident="ident-token",e.Number="number-token",e.Percentage="percentage-token",e.Semicolon="semicolon-token",e.String="string-token",e.URL="url-token",e.Whitespace="whitespace-token",e.OpenParen="(-token",e.CloseParen=")-token",e.OpenSquare="[-token",e.CloseSquare="]-token",e.OpenCurly="{-token",e.CloseCurly="}-token",exports.NumberType=void 0,(o=exports.NumberType||(exports.NumberType={})).Integer="integer",o.Number="number",function(e){e.Unrestricted="unrestricted",e.ID="id"}(t||(t={}));const r="'".charCodeAt(0),n="*".charCodeAt(0),s="\b".charCodeAt(0),i="\r".charCodeAt(0),c="\t".charCodeAt(0),a=":".charCodeAt(0),d=",".charCodeAt(0),u="@".charCodeAt(0),p="".charCodeAt(0),C="!".charCodeAt(0),S="\f".charCodeAt(0),P=".".charCodeAt(0),h=">".charCodeAt(0),T="-".charCodeAt(0),l="".charCodeAt(0),m="E".charCodeAt(0),k="e".charCodeAt(0),f="{".charCodeAt(0),E="(".charCodeAt(0),v="[".charCodeAt(0),A="<".charCodeAt(0),x="\n".charCodeAt(0),y="\v".charCodeAt(0),g="_".charCodeAt(0),I="􏿿".charCodeAt(0),U="\0".charCodeAt(0),O="#".charCodeAt(0),D="%".charCodeAt(0),w="+".charCodeAt(0),L='"'.charCodeAt(0),b="�".charCodeAt(0),N="\\".charCodeAt(0),R="}".charCodeAt(0),W=")".charCodeAt(0),F="]".charCodeAt(0),q=";".charCodeAt(0),V="".charCodeAt(0),B="/".charCodeAt(0),H=" ".charCodeAt(0);function checkIfFourCodePointsWouldStartCDO(e,o){return o.codePointSource[o.cursor]===A&&o.codePointSource[o.cursor+1]===C&&o.codePointSource[o.cursor+2]===T&&o.codePointSource[o.cursor+3]===T}const z="0".charCodeAt(0),K="9".charCodeAt(0);function isDigitCodePoint(e){return z<=e&&e<=K}const M="A".charCodeAt(0),J="Z".charCodeAt(0);function isUppercaseLetterCodePoint(e){return M<=e&&e<=J}const Q="a".charCodeAt(0),Z="z".charCodeAt(0);function isLowercaseLetterCodePoint(e){return Q<=e&&e<=Z}const _="F".charCodeAt(0),j="f".charCodeAt(0);function isHexDigitCodePoint(e){return z<=e&&e<=K||(Q<=e&&e<=j||M<=e&&e<=_)}function isLetterCodePoint(e){return isLowercaseLetterCodePoint(e)||isUppercaseLetterCodePoint(e)}const G="".charCodeAt(0);function isNonASCIICodePoint(e){return e>=G}function isIdentStartCodePoint(e){return!!isLetterCodePoint(e)||(!!isNonASCIICodePoint(e)||e===g)}function isIdentCodePoint(e){return!!isIdentStartCodePoint(e)||(!!isDigitCodePoint(e)||e===T)}function isNewLine(e){switch(e){case x:case i:case S:return!0;default:return!1}}function isWhitespace(e){switch(e){case x:case i:case S:case c:case H:return!0;default:return!1}}const X="\ud800".charCodeAt(0),Y="\udfff".charCodeAt(0);function checkIfTwoCodePointsAreAValidEscape(e,o){return o.codePointSource[o.cursor]===N&&o.codePointSource[o.cursor+1]!==x}function checkIfThreeCodePointsWouldStartAnIdentSequence(e,o){return o.codePointSource[o.cursor]===T?o.codePointSource[o.cursor+1]===T||(!!isIdentStartCodePoint(o.codePointSource[o.cursor+1])||o.codePointSource[o.cursor+1]===N&&o.codePointSource[o.cursor+2]!==x):!!isIdentStartCodePoint(o.codePointSource[o.cursor])||checkIfTwoCodePointsAreAValidEscape(0,o)}function checkIfThreeCodePointsWouldStartANumber(e,o){return o.codePointSource[o.cursor]===w||o.codePointSource[o.cursor]===T?!!isDigitCodePoint(o.codePointSource[o.cursor+1])||o.codePointSource[o.cursor+1]===P&&isDigitCodePoint(o.codePointSource[o.cursor+2]):o.codePointSource[o.cursor]===P?isDigitCodePoint(o.codePointSource[o.cursor+1]):!!isDigitCodePoint(o.codePointSource[o.cursor])}function checkIfTwoCodePointsStartAComment(e,o){return o.codePointSource[o.cursor]===B&&o.codePointSource[o.cursor+1]===n}function checkIfThreeCodePointsWouldStartCDC(e,o){return o.codePointSource[o.cursor]===T&&o.codePointSource[o.cursor+1]===T&&o.codePointSource[o.cursor+2]===h}function consumeComment(e,o){for(o.advanceCodePoint(2);;){const t=o.readCodePoint();if(!1===t){e.onParseError({message:"Unexpected EOF while consuming a comment.",start:o.representationStart,end:o.representationEnd,state:["4.3.2. Consume comments","Unexpected EOF"]});break}if(t===n&&(void 0!==o.codePointSource[o.cursor]&&o.codePointSource[o.cursor]===B)){o.advanceCodePoint();break}}return[exports.TokenType.Comment,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,void 0]}function consumeEscapedCodePoint(e,o){const t=o.readCodePoint();if(!1===t)return e.onParseError({message:"Unexpected EOF while consuming an escaped code point.",start:o.representationStart,end:o.representationEnd,state:["4.3.7. Consume an escaped code point","Unexpected EOF"]}),b;if(isHexDigitCodePoint(t)){const e=[t];for(;void 0!==o.codePointSource[o.cursor]&&isHexDigitCodePoint(o.codePointSource[o.cursor])&&e.length<6;)e.push(o.codePointSource[o.cursor]),o.advanceCodePoint();isWhitespace(o.codePointSource[o.cursor])&&o.advanceCodePoint();const n=parseInt(String.fromCharCode(...e),16);return 0===n?b:X<=(r=n)&&r<=Y||n>I?b:n}var r;return t}function consumeIdentSequence(e,o){const t=[];for(;;)if(isIdentCodePoint(o.codePointSource[o.cursor]))t.push(o.codePointSource[o.cursor]),o.advanceCodePoint();else{if(!checkIfTwoCodePointsAreAValidEscape(0,o))return t;o.advanceCodePoint(),t.push(consumeEscapedCodePoint(e,o))}}function consumeHashToken(e,o){if(o.advanceCodePoint(),void 0!==o.codePointSource[o.cursor]&&isIdentCodePoint(o.codePointSource[o.cursor])||checkIfTwoCodePointsAreAValidEscape(0,o)){let r=t.Unrestricted;checkIfThreeCodePointsWouldStartAnIdentSequence(0,o)&&(r=t.ID);const n=consumeIdentSequence(e,o);return[exports.TokenType.Hash,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:String.fromCharCode(...n),type:r}]}return[exports.TokenType.Delim,"#",o.representationStart,o.representationEnd,{value:"#"}]}function consumeNumber(e,o){let t=exports.NumberType.Integer;for(o.codePointSource[o.cursor]!==w&&o.codePointSource[o.cursor]!==T||o.advanceCodePoint();isDigitCodePoint(o.codePointSource[o.cursor]);)o.advanceCodePoint();if(o.codePointSource[o.cursor]===P&&isDigitCodePoint(o.codePointSource[o.cursor+1]))for(o.advanceCodePoint(2),t=exports.NumberType.Number;isDigitCodePoint(o.codePointSource[o.cursor]);)o.advanceCodePoint();if((o.codePointSource[o.cursor]===k||o.codePointSource[o.cursor]===m)&&isDigitCodePoint(o.codePointSource[o.cursor+1]))for(o.advanceCodePoint(2),t=exports.NumberType.Number;isDigitCodePoint(o.codePointSource[o.cursor]);)o.advanceCodePoint();if((o.codePointSource[o.cursor]===k||o.codePointSource[o.cursor]===m)&&(o.codePointSource[o.cursor+1]===T||o.codePointSource[o.cursor+1]===w)&&isDigitCodePoint(o.codePointSource[o.cursor+2]))for(o.advanceCodePoint(3),t=exports.NumberType.Number;isDigitCodePoint(o.codePointSource[o.cursor]);)o.advanceCodePoint();return[parseFloat(o.source.slice(o.representationStart,o.representationEnd+1)),t]}function consumeNumericToken(e,o){const t=consumeNumber(0,o);if(checkIfThreeCodePointsWouldStartAnIdentSequence(0,o)){const r=consumeIdentSequence(e,o);return[exports.TokenType.Dimension,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:t[0],type:t[1],unit:String.fromCharCode(...r)}]}return o.codePointSource[o.cursor]===D?(o.advanceCodePoint(),[exports.TokenType.Percentage,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:t[0]}]):[exports.TokenType.Number,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:t[0],type:t[1]}]}function consumeWhiteSpace(e,o){for(;isWhitespace(o.codePointSource[o.cursor]);)o.advanceCodePoint();return[exports.TokenType.Whitespace,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,void 0]}function consumeStringToken(e,o){let t="";const r=o.readCodePoint();for(;;){const n=o.readCodePoint();if(!1===n)return e.onParseError({message:"Unexpected EOF while consuming a string token.",start:o.representationStart,end:o.representationEnd,state:["4.3.5. Consume a string token","Unexpected EOF"]}),[exports.TokenType.String,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:t}];if(isNewLine(n))return e.onParseError({message:"Unexpected newline while consuming a string token.",start:o.representationStart,end:o.representationEnd,state:["4.3.5. Consume a string token","Unexpected newline"]}),o.unreadCodePoint(),[exports.TokenType.BadString,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,void 0];if(n===r)return[exports.TokenType.String,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:t}];if(n!==N)t+=String.fromCharCode(n);else{if(void 0===o.codePointSource[o.cursor])continue;if(isNewLine(o.codePointSource[o.cursor])){o.advanceCodePoint();continue}t+=String.fromCharCode(consumeEscapedCodePoint(e,o))}}}const $="u".charCodeAt(0),ee="U".charCodeAt(0),oe="r".charCodeAt(0),te="R".charCodeAt(0),re="l".charCodeAt(0),ne="L".charCodeAt(0);function checkIfCodePointsMatchURLIdent(e,o){return 3===o.length&&((o[0]===$||o[0]===ee)&&((o[1]===oe||o[1]===te)&&(o[2]===re||o[2]===ne)))}function consumeBadURL(e,o){for(;;){if(void 0===o.codePointSource[o.cursor])return;if(o.codePointSource[o.cursor]===W)return void o.advanceCodePoint();checkIfTwoCodePointsAreAValidEscape(0,o)?(o.advanceCodePoint(),consumeEscapedCodePoint(e,o)):o.advanceCodePoint()}}function consumeUrlToken(e,o){consumeWhiteSpace(0,o);let t="";for(;;){if(void 0===o.codePointSource[o.cursor])return e.onParseError({message:"Unexpected EOF while consuming a url token.",start:o.representationStart,end:o.representationEnd,state:["4.3.6. Consume a url token","Unexpected EOF"]}),[exports.TokenType.URL,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:t}];if(o.codePointSource[o.cursor]===W)return o.advanceCodePoint(),[exports.TokenType.URL,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:t}];if(isWhitespace(o.codePointSource[o.cursor]))return consumeWhiteSpace(0,o),void 0===o.codePointSource[o.cursor]?(e.onParseError({message:"Unexpected EOF while consuming a url token.",start:o.representationStart,end:o.representationEnd,state:["4.3.6. Consume a url token","Consume as much whitespace as possible","Unexpected EOF"]}),[exports.TokenType.URL,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:t}]):o.codePointSource[o.cursor]===W?(o.advanceCodePoint(),[exports.TokenType.URL,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:t}]):(consumeBadURL(e,o),[exports.TokenType.BadURL,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,void 0]);if(o.codePointSource[o.cursor]===L||o.codePointSource[o.cursor]===r||o.codePointSource[o.cursor]===E||((n=o.codePointSource[o.cursor])===y||n===p||U<=n&&n<=s||V<=n&&n<=l))return consumeBadURL(e,o),e.onParseError({message:"Unexpected character while consuming a url token.",start:o.representationStart,end:o.representationEnd,state:["4.3.6. Consume a url token","Unexpected U+0022 QUOTATION MARK (\"), U+0027 APOSTROPHE ('), U+0028 LEFT PARENTHESIS (() or non-printable code point"]}),[exports.TokenType.BadURL,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,void 0];if(o.codePointSource[o.cursor]===N){if(checkIfTwoCodePointsAreAValidEscape(0,o)){t+=String.fromCharCode(consumeEscapedCodePoint(e,o));continue}return consumeBadURL(e,o),e.onParseError({message:"Invalid escape sequence while consuming a url token.",start:o.representationStart,end:o.representationEnd,state:["4.3.6. Consume a url token","U+005C REVERSE SOLIDUS (\\)","The input stream does not start with a valid escape sequence"]}),[exports.TokenType.BadURL,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,void 0]}t+=String.fromCharCode(o.codePointSource[o.cursor]),o.advanceCodePoint()}var n}function consumeIdentLikeToken(e,o){const t=consumeIdentSequence(e,o);if(o.codePointSource[o.cursor]!==E)return[exports.TokenType.Ident,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:String.fromCharCode(...t)}];if(checkIfCodePointsMatchURLIdent(0,t)){o.advanceCodePoint();let n=0;for(;;){const e=isWhitespace(o.codePointSource[o.cursor]),s=isWhitespace(o.codePointSource[o.cursor+1]);if(e&&s){n+=2,o.advanceCodePoint(2);continue}const i=e?o.codePointSource[o.cursor+1]:o.codePointSource[o.cursor];if(i===L||i===r)return n>0&&o.advanceCodePoint(n),[exports.TokenType.Function,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:String.fromCharCode(...t)}];break}return n>0&&o.advanceCodePoint(n),consumeUrlToken(e,o)}return o.advanceCodePoint(),[exports.TokenType.Function,o.source.slice(o.representationStart,o.representationEnd+1),o.representationStart,o.representationEnd,{value:String.fromCharCode(...t)}]}exports.Reader=Reader,exports.cloneTokens=function cloneTokens(e){return"undefined"!=typeof globalThis&&"structuredClone"in globalThis?structuredClone(e):JSON.parse(JSON.stringify(e))},exports.isToken=function isToken(e){return!!Array.isArray(e)&&(!(e.length<4)&&(e[0]in exports.TokenType&&("string"==typeof e[1]&&("number"==typeof e[2]&&"number"==typeof e[3]))))},exports.mirrorVariantType=function mirrorVariantType(e){switch(e){case exports.TokenType.OpenParen:return exports.TokenType.CloseParen;case exports.TokenType.CloseParen:return exports.TokenType.OpenParen;case exports.TokenType.OpenCurly:return exports.TokenType.CloseCurly;case exports.TokenType.CloseCurly:return exports.TokenType.OpenCurly;case exports.TokenType.OpenSquare:return exports.TokenType.CloseSquare;case exports.TokenType.CloseSquare:return exports.TokenType.OpenSquare;default:return null}},exports.stringify=function stringify(...e){let o="";for(let t=0;t<e.length;t++)o+=e[t][1];return o},exports.tokenizer=function tokenizer(e,o){const t=e.css.valueOf(),n=new Reader(t),s={onParseError:(null==o?void 0:o.onParseError)??(()=>{})};return{nextToken:function nextToken(){if(n.representationStart=n.cursor,n.representationEnd=-1,checkIfTwoCodePointsStartAComment(0,n)){if(null!=o&&o.commentsAreTokens)return consumeComment(s,n);consumeComment(s,n),n.representationStart=n.cursor,n.representationEnd=-1}const e=n.codePointSource[n.cursor];if(void 0===e)return[exports.TokenType.EOF,"",-1,-1,void 0];if(isIdentStartCodePoint(e))return consumeIdentLikeToken(s,n);if(isDigitCodePoint(e))return consumeNumericToken(s,n);switch(e){case d:return n.advanceCodePoint(),[exports.TokenType.Comma,",",n.representationStart,n.representationEnd,void 0];case a:return n.advanceCodePoint(),[exports.TokenType.Colon,":",n.representationStart,n.representationEnd,void 0];case q:return n.advanceCodePoint(),[exports.TokenType.Semicolon,";",n.representationStart,n.representationEnd,void 0];case E:return n.advanceCodePoint(),[exports.TokenType.OpenParen,"(",n.representationStart,n.representationEnd,void 0];case W:return n.advanceCodePoint(),[exports.TokenType.CloseParen,")",n.representationStart,n.representationEnd,void 0];case v:return n.advanceCodePoint(),[exports.TokenType.OpenSquare,"[",n.representationStart,n.representationEnd,void 0];case F:return n.advanceCodePoint(),[exports.TokenType.CloseSquare,"]",n.representationStart,n.representationEnd,void 0];case f:return n.advanceCodePoint(),[exports.TokenType.OpenCurly,"{",n.representationStart,n.representationEnd,void 0];case R:return n.advanceCodePoint(),[exports.TokenType.CloseCurly,"}",n.representationStart,n.representationEnd,void 0];case r:case L:return consumeStringToken(s,n);case O:return consumeHashToken(s,n);case w:case P:return checkIfThreeCodePointsWouldStartANumber(0,n)?consumeNumericToken(s,n):(n.advanceCodePoint(),[exports.TokenType.Delim,n.source[n.representationStart],n.representationStart,n.representationEnd,{value:n.source[n.representationStart]}]);case x:case i:case S:case c:case H:return consumeWhiteSpace(0,n);case T:return checkIfThreeCodePointsWouldStartANumber(0,n)?consumeNumericToken(s,n):checkIfThreeCodePointsWouldStartCDC(0,n)?(n.advanceCodePoint(3),[exports.TokenType.CDC,"--\x3e",n.representationStart,n.representationEnd,void 0]):checkIfThreeCodePointsWouldStartAnIdentSequence(0,n)?consumeIdentLikeToken(s,n):(n.advanceCodePoint(),[exports.TokenType.Delim,"-",n.representationStart,n.representationEnd,{value:"-"}]);case A:return checkIfFourCodePointsWouldStartCDO(0,n)?(n.advanceCodePoint(4),[exports.TokenType.CDO,"\x3c!--",n.representationStart,n.representationEnd,void 0]):(n.advanceCodePoint(),[exports.TokenType.Delim,"<",n.representationStart,n.representationEnd,{value:"<"}]);case u:if(n.advanceCodePoint(),checkIfThreeCodePointsWouldStartAnIdentSequence(0,n)){const e=consumeIdentSequence(s,n);return[exports.TokenType.AtKeyword,n.source.slice(n.representationStart,n.representationEnd+1),n.representationStart,n.representationEnd,{value:String.fromCharCode(...e)}]}return[exports.TokenType.Delim,"@",n.representationStart,n.representationEnd,{value:"@"}];case N:return checkIfTwoCodePointsAreAValidEscape(0,n)?consumeIdentLikeToken(s,n):(n.advanceCodePoint(),s.onParseError({message:'Invalid escape sequence after "\\"',start:n.representationStart,end:n.representationEnd,state:["4.3.1. Consume a token","U+005C REVERSE SOLIDUS (\\)","The input stream does not start with a valid escape sequence"]}),[exports.TokenType.Delim,"\\",n.representationStart,n.representationEnd,{value:"\\"}])}return n.advanceCodePoint(),[exports.TokenType.Delim,n.source[n.representationStart],n.representationStart,n.representationEnd,{value:n.source[n.representationStart]}]},endOfFile:function endOfFile(){return void 0===n.codePointSource[n.cursor]}}};
