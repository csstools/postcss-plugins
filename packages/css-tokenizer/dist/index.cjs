"use strict";class Reader{cursor;stringSource="";codePointSource=[];length=0;representationStart=0;representationEnd=-1;constructor(e){this.cursor=0,this.stringSource=e,this.length=e.length,this.codePointSource=new Array(this.length);for(let e=0;e<this.length;e++)this.codePointSource[e]=this.stringSource.charCodeAt(e)}cursorPositionOfLastReadCodePoint(){return this.cursor-1}readCodePoint(e=1){const r=this.codePointSource[this.cursor];return void 0!==r&&(this.cursor+=e,this.representationEnd=this.cursor-1,r)}unreadCodePoint(e=1){return 0!==this.cursor&&(this.cursor-=e,this.representationEnd=this.cursor-1,!0)}representationString(){return-1===this.representationEnd?"":this.stringSource.slice(this.representationStart,this.representationEnd+1)}resetRepresentation(){this.representationStart=this.cursor,this.representationEnd=-1}slice(e,r){return this.stringSource.slice(e,r)}}var e,r,o;exports.TokenType=void 0,(e=exports.TokenType||(exports.TokenType={})).Comment="comment",e.AtKeyword="at-keyword-token",e.BadString="bad-string-token",e.BadURL="bad-url-token",e.CDC="CDC-token",e.CDO="CDO-token",e.Colon="colon-token",e.Comma="comma-token",e.Delim="delim-token",e.Dimension="dimension-token",e.EOF="EOF-token",e.Function="function-token",e.Hash="hash-token",e.Ident="ident-token",e.Number="number-token",e.Percentage="percentage-token",e.Semicolon="semicolon-token",e.String="string-token",e.URL="url-token",e.Whitespace="whitespace-token",e.OpenParen="(-token",e.CloseParen=")-token",e.OpenSquare="[-token",e.CloseSquare="]-token",e.OpenCurly="{-token",e.CloseCurly="}-token",exports.NumberType=void 0,(r=exports.NumberType||(exports.NumberType={})).Integer="integer",r.Number="number",function(e){e.Unrestricted="unrestricted",e.ID="id"}(o||(o={}));const t="'".charCodeAt(0),n="*".charCodeAt(0),i="\b".charCodeAt(0),s="\r".charCodeAt(0),c="\t".charCodeAt(0),a=":".charCodeAt(0),d=",".charCodeAt(0),u="@".charCodeAt(0),p="".charCodeAt(0),C="!".charCodeAt(0),S="\f".charCodeAt(0),P=".".charCodeAt(0),h=">".charCodeAt(0),T="-".charCodeAt(0),l="".charCodeAt(0),m="E".charCodeAt(0),f="e".charCodeAt(0),k="{".charCodeAt(0),g="(".charCodeAt(0),A="[".charCodeAt(0),E="<".charCodeAt(0),x="\n".charCodeAt(0),y="\v".charCodeAt(0),v="_".charCodeAt(0),I="􏿿".charCodeAt(0),D="\0".charCodeAt(0),U="#".charCodeAt(0),O="%".charCodeAt(0),w="+".charCodeAt(0),b='"'.charCodeAt(0),L="�".charCodeAt(0),N="\\".charCodeAt(0),R="}".charCodeAt(0),W=")".charCodeAt(0),F="]".charCodeAt(0),q=";".charCodeAt(0),V="".charCodeAt(0),B="/".charCodeAt(0),H=" ".charCodeAt(0),M="0".charCodeAt(0),z="1".charCodeAt(0),K="2".charCodeAt(0),J="3".charCodeAt(0),Q="4".charCodeAt(0),Z="5".charCodeAt(0),_="6".charCodeAt(0),j="7".charCodeAt(0),G="8".charCodeAt(0),X="9".charCodeAt(0);function checkIfFourCodePointsWouldStartCDO(e,r){return r.codePointSource[r.cursor]===E&&r.codePointSource[r.cursor+1]===C&&r.codePointSource[r.cursor+2]===T&&r.codePointSource[r.cursor+3]===T}const Y="0".charCodeAt(0),$="9".charCodeAt(0);function isDigitCodePoint(e){return Y<=e&&e<=$}const ee="A".charCodeAt(0),re="Z".charCodeAt(0);function isUppercaseLetterCodePoint(e){return ee<=e&&e<=re}const oe="a".charCodeAt(0),te="z".charCodeAt(0);function isLowercaseLetterCodePoint(e){return oe<=e&&e<=te}const ne="F".charCodeAt(0),ie="f".charCodeAt(0);function isHexDigitCodePoint(e){return Y<=e&&e<=$||(oe<=e&&e<=ie||ee<=e&&e<=ne)}function isLetterCodePoint(e){return isLowercaseLetterCodePoint(e)||isUppercaseLetterCodePoint(e)}const se="".charCodeAt(0);function isNonASCIICodePoint(e){return e>=se}function isIdentStartCodePoint(e){return!!isLetterCodePoint(e)||(!!isNonASCIICodePoint(e)||e===v)}function isIdentCodePoint(e){return!!isIdentStartCodePoint(e)||(!!isDigitCodePoint(e)||e===T)}function isNewLine(e){switch(e){case x:case s:case S:return!0;default:return!1}}function isWhitespace(e){switch(e){case x:case s:case S:case c:case H:return!0;default:return!1}}const ce="\ud800".charCodeAt(0),ae="\udfff".charCodeAt(0);function checkIfTwoCodePointsAreAValidEscape(e,r){return r.codePointSource[r.cursor]===N&&r.codePointSource[r.cursor+1]!==x}function checkIfThreeCodePointsWouldStartAnIdentSequence(e,r){return r.codePointSource[r.cursor]===T?r.codePointSource[r.cursor+1]===T||(!!isIdentStartCodePoint(r.codePointSource[r.cursor+1])||r.codePointSource[r.cursor+1]===N&&r.codePointSource[r.cursor+2]!==x):!!isIdentStartCodePoint(r.codePointSource[r.cursor])||checkIfTwoCodePointsAreAValidEscape(0,r)}function checkIfThreeCodePointsWouldStartANumber(e,r){return r.codePointSource[r.cursor]===w||r.codePointSource[r.cursor]===T?!!isDigitCodePoint(r.codePointSource[r.cursor+1])||r.codePointSource[r.cursor+1]===P&&isDigitCodePoint(r.codePointSource[r.cursor+2]):r.codePointSource[r.cursor]===P?isDigitCodePoint(r.codePointSource[r.cursor+1]):!!isDigitCodePoint(r.codePointSource[r.cursor])}function checkIfTwoCodePointsStartAComment(e,r){return r.codePointSource[r.cursor]===B&&r.codePointSource[r.cursor+1]===n}function checkIfThreeCodePointsWouldStartCDC(e,r){return r.codePointSource[r.cursor]===T&&r.codePointSource[r.cursor+1]===T&&r.codePointSource[r.cursor+2]===h}function consumeComment(e,r){for(r.readCodePoint(2);;){const o=r.readCodePoint();if(!1===o){e.onParseError({message:"Unexpected EOF while consuming a comment.",start:r.representationStart,end:r.representationEnd,state:["4.3.2. Consume comments","Unexpected EOF"]});break}if(o===n&&(void 0!==r.codePointSource[r.cursor]&&r.codePointSource[r.cursor]===B)){r.readCodePoint();break}}return[exports.TokenType.Comment,r.representationString(),r.representationStart,r.representationEnd,void 0]}function consumeEscapedCodePoint(e,r){const o=r.readCodePoint();if(!1===o)return e.onParseError({message:"Unexpected EOF while consuming an escaped code point.",start:r.representationStart,end:r.representationEnd,state:["4.3.7. Consume an escaped code point","Unexpected EOF"]}),L;if(isHexDigitCodePoint(o)){const e=[o];for(;void 0!==r.codePointSource[r.cursor]&&isHexDigitCodePoint(r.codePointSource[r.cursor])&&e.length<6;)e.push(r.codePointSource[r.cursor]),r.readCodePoint();isWhitespace(r.codePointSource[r.cursor])&&r.readCodePoint();const n=parseInt(String.fromCharCode(...e),16);return 0===n?L:ce<=(t=n)&&t<=ae||n>I?L:n}var t;return o}function consumeIdentSequence(e,r){const o=[];for(;;){if(void 0===r.codePointSource[r.cursor])return o;if(isIdentCodePoint(r.codePointSource[r.cursor]))o.push(r.codePointSource[r.cursor]),r.readCodePoint();else{if(!checkIfTwoCodePointsAreAValidEscape(0,r))return o;r.readCodePoint(),o.push(consumeEscapedCodePoint(e,r))}}}function consumeHashToken(e,r){if(r.readCodePoint(),void 0!==r.codePointSource[r.cursor]&&isIdentCodePoint(r.codePointSource[r.cursor])||checkIfTwoCodePointsAreAValidEscape(0,r)){let t=o.Unrestricted;checkIfThreeCodePointsWouldStartAnIdentSequence(0,r)&&(t=o.ID);const n=consumeIdentSequence(e,r);return[exports.TokenType.Hash,r.representationString(),r.representationStart,r.representationEnd,{value:String.fromCharCode(...n),type:t}]}return[exports.TokenType.Delim,r.representationString(),r.representationStart,r.representationEnd,{value:"#"}]}function consumeNumber(e,r){let o=exports.NumberType.Integer;const t=[];{r.codePointSource[r.cursor]!==w&&r.codePointSource[r.cursor]!==T||(t.push(r.codePointSource[r.cursor]),r.readCodePoint());const e=consumeDigits(r);for(let r=0;r<e.length;r++)t.push(e[r])}if(r.codePointSource[r.cursor]===P&&isDigitCodePoint(r.codePointSource[r.cursor+1])){t.push(r.codePointSource[r.cursor]),t.push(r.codePointSource[r.cursor+1]),r.readCodePoint(2),o=exports.NumberType.Number;const e=consumeDigits(r);for(let r=0;r<e.length;r++)t.push(e[r])}if((r.codePointSource[r.cursor]===f||r.codePointSource[r.cursor]===m)&&isDigitCodePoint(r.codePointSource[r.cursor+1])){t.push(r.codePointSource[r.cursor]),t.push(r.codePointSource[r.cursor+1]),r.readCodePoint(2),o=exports.NumberType.Number;const e=consumeDigits(r);for(let r=0;r<e.length;r++)t.push(e[r])}if((r.codePointSource[r.cursor]===f||r.codePointSource[r.cursor]===m)&&(r.codePointSource[r.cursor+1]===T||r.codePointSource[r.cursor+1]===w)&&isDigitCodePoint(r.codePointSource[r.cursor+2])){t.push(r.codePointSource[r.cursor]),t.push(r.codePointSource[r.cursor+1]),t.push(r.codePointSource[r.cursor+2]),r.readCodePoint(3),o=exports.NumberType.Number;const e=consumeDigits(r);for(let r=0;r<e.length;r++)t.push(e[r])}return[convertCodePointsToNumber(t),o]}function consumeDigits(e){const r=[];for(;;){if(void 0===e.codePointSource[e.cursor])return r;if(!isDigitCodePoint(e.codePointSource[e.cursor]))return r;r.push(e.codePointSource[e.cursor]),e.readCodePoint()}}function convertCodePointsToNumber(e){let r=1;const o=[];let t=0,n=0;const i=[];let s=0,c=1;const a=[];let d=0,u=0;for(e[u]===T?(u++,r=-1):e[u]===w&&u++;u<e.length&&isDigitCodePoint(e[u]);)o.push(e[u]),u++;for(t=digitCodePointsToInteger(o),e[u]===P&&u++;u<e.length&&isDigitCodePoint(e[u]);)i.push(e[u]),u++;for(n=i.length,s=digitCodePointsToInteger(i)/Math.pow(10,n),e[u]!==f&&e[u]!==m||u++,e[u]===T?(u++,c=-1):e[u]===w&&u++;u<e.length&&isDigitCodePoint(e[u]);)a.push(e[u]),u++;return d=digitCodePointsToInteger(a),r*(t+s)*Math.pow(10,c*d)}function digitCodePointsToInteger(e){return 0===e.length?0:Number.parseInt(String.fromCharCode(...e),10)}function consumeNumericToken(e,r){const o=consumeNumber(0,r);if(checkIfThreeCodePointsWouldStartAnIdentSequence(0,r)){const t=consumeIdentSequence(e,r);return[exports.TokenType.Dimension,r.representationString(),r.representationStart,r.representationEnd,{value:o[0],type:o[1],unit:String.fromCharCode(...t)}]}return r.codePointSource[r.cursor]===O?(r.readCodePoint(),[exports.TokenType.Percentage,r.representationString(),r.representationStart,r.representationEnd,{value:o[0]}]):[exports.TokenType.Number,r.representationString(),r.representationStart,r.representationEnd,{value:o[0],type:o[1]}]}function consumeWhiteSpace(e,r,o=-1){let t=0;for(;;){if(-1!==o&&t===o)return[exports.TokenType.Whitespace,r.representationString(),r.representationStart,r.representationEnd,void 0];if(t++,void 0===r.codePointSource[r.cursor])return[exports.TokenType.Whitespace,r.representationString(),r.representationStart,r.representationEnd,void 0];if(!isWhitespace(r.codePointSource[r.cursor]))break;r.readCodePoint()}return[exports.TokenType.Whitespace,r.representationString(),r.representationStart,r.representationEnd,void 0]}function consumeStringToken(e,r){let o="";const t=r.readCodePoint();if(!1===t)throw new Error("Unexpected EOF");for(;;){const n=r.readCodePoint();if(!1===n)return e.onParseError({message:"Unexpected EOF while consuming a string token.",start:r.representationStart,end:r.representationEnd,state:["4.3.5. Consume a string token","Unexpected EOF"]}),[exports.TokenType.String,r.representationString(),r.representationStart,r.representationEnd,{value:o}];if(isNewLine(n))return e.onParseError({message:"Unexpected newline while consuming a string token.",start:r.representationStart,end:r.representationEnd,state:["4.3.5. Consume a string token","Unexpected newline"]}),r.unreadCodePoint(),[exports.TokenType.BadString,r.representationString(),r.representationStart,r.representationEnd,void 0];if(n===t)return[exports.TokenType.String,r.representationString(),r.representationStart,r.representationEnd,{value:o}];if(n!==N)o+=String.fromCharCode(n);else{if(void 0===r.codePointSource[r.cursor])continue;if(isNewLine(r.codePointSource[r.cursor])){r.readCodePoint();continue}o+=String.fromCharCode(consumeEscapedCodePoint(e,r))}}}const de="u".charCodeAt(0),ue="U".charCodeAt(0),pe="r".charCodeAt(0),Ce="R".charCodeAt(0),Se="l".charCodeAt(0),Pe="L".charCodeAt(0);function checkIfCodePointsMatchURLIdent(e,r){return 3===r.length&&((r[0]===de||r[0]===ue)&&((r[1]===pe||r[1]===Ce)&&(r[2]===Se||r[2]===Pe)))}function consumeBadURL(e,r){for(;;){if(void 0===r.codePointSource[r.cursor])return;if(r.codePointSource[r.cursor]===W)return void r.readCodePoint();checkIfTwoCodePointsAreAValidEscape(0,r)?(r.readCodePoint(),consumeEscapedCodePoint(e,r)):r.readCodePoint()}}function consumeUrlToken(e,r){consumeWhiteSpace(0,r);let o="";for(;;){if(void 0===r.codePointSource[r.cursor])return e.onParseError({message:"Unexpected EOF while consuming a url token.",start:r.representationStart,end:r.representationEnd,state:["4.3.6. Consume a url token","Unexpected EOF"]}),[exports.TokenType.URL,r.representationString(),r.representationStart,r.representationEnd,{value:o}];if(r.codePointSource[r.cursor]===W)return r.readCodePoint(),[exports.TokenType.URL,r.representationString(),r.representationStart,r.representationEnd,{value:o}];if(isWhitespace(r.codePointSource[r.cursor]))return consumeWhiteSpace(0,r),void 0===r.codePointSource[r.cursor]?(e.onParseError({message:"Unexpected EOF while consuming a url token.",start:r.representationStart,end:r.representationEnd,state:["4.3.6. Consume a url token","Consume as much whitespace as possible","Unexpected EOF"]}),[exports.TokenType.URL,r.representationString(),r.representationStart,r.representationEnd,{value:o}]):r.codePointSource[r.cursor]===W?(r.readCodePoint(),[exports.TokenType.URL,r.representationString(),r.representationStart,r.representationEnd,{value:o}]):(consumeBadURL(e,r),[exports.TokenType.BadURL,r.representationString(),r.representationStart,r.representationEnd,void 0]);if(r.codePointSource[r.cursor]===b||r.codePointSource[r.cursor]===t||r.codePointSource[r.cursor]===g||((n=r.codePointSource[r.cursor])===y||n===p||D<=n&&n<=i||V<=n&&n<=l))return consumeBadURL(e,r),e.onParseError({message:"Unexpected character while consuming a url token.",start:r.representationStart,end:r.representationEnd,state:["4.3.6. Consume a url token","Unexpected U+0022 QUOTATION MARK (\"), U+0027 APOSTROPHE ('), U+0028 LEFT PARENTHESIS (() or non-printable code point"]}),[exports.TokenType.BadURL,r.representationString(),r.representationStart,r.representationEnd,void 0];if(r.codePointSource[r.cursor]===N){if(checkIfTwoCodePointsAreAValidEscape(0,r)){o+=String.fromCharCode(consumeEscapedCodePoint(e,r));continue}return consumeBadURL(e,r),e.onParseError({message:"Invalid escape sequence while consuming a url token.",start:r.representationStart,end:r.representationEnd,state:["4.3.6. Consume a url token","U+005C REVERSE SOLIDUS (\\)","The input stream does not start with a valid escape sequence"]}),[exports.TokenType.BadURL,r.representationString(),r.representationStart,r.representationEnd,void 0]}o+=String.fromCharCode(r.codePointSource[r.cursor]),r.readCodePoint()}var n}function consumeIdentLikeToken(e,r){const o=consumeIdentSequence(e,r);if(r.codePointSource[r.cursor]!==g)return[exports.TokenType.Ident,r.representationString(),r.representationStart,r.representationEnd,{value:String.fromCharCode(...o)}];if(checkIfCodePointsMatchURLIdent(0,o)){r.readCodePoint();let n=0;for(;;){const e=isWhitespace(r.codePointSource[r.cursor]),i=isWhitespace(r.codePointSource[r.cursor+1]);if(e&&i){n+=2,r.readCodePoint(2);continue}const s=e?r.codePointSource[r.cursor+1]:r.codePointSource[r.cursor];if(s===b||s===t)return n>0&&r.unreadCodePoint(n),[exports.TokenType.Function,r.representationString(),r.representationStart,r.representationEnd,{value:String.fromCharCode(...o)}];break}return n>0&&r.unreadCodePoint(n),consumeUrlToken(e,r)}return r.readCodePoint(),[exports.TokenType.Function,r.representationString(),r.representationStart,r.representationEnd,{value:String.fromCharCode(...o)}]}exports.Reader=Reader,exports.cloneTokens=function cloneTokens(e){return"undefined"!=typeof globalThis&&"structuredClone"in globalThis?structuredClone(e):JSON.parse(JSON.stringify(e))},exports.isToken=function isToken(e){return!!Array.isArray(e)&&(!(e.length<4)&&(e[0]in exports.TokenType&&("string"==typeof e[1]&&("number"==typeof e[2]&&"number"==typeof e[3]))))},exports.mirrorVariantType=function mirrorVariantType(e){switch(e){case exports.TokenType.OpenParen:return exports.TokenType.CloseParen;case exports.TokenType.CloseParen:return exports.TokenType.OpenParen;case exports.TokenType.OpenCurly:return exports.TokenType.CloseCurly;case exports.TokenType.CloseCurly:return exports.TokenType.OpenCurly;case exports.TokenType.OpenSquare:return exports.TokenType.CloseSquare;case exports.TokenType.CloseSquare:return exports.TokenType.OpenSquare;default:return null}},exports.stringify=function stringify(...e){let r="";for(let o=0;o<e.length;o++)r+=e[o][1];return r},exports.tokenizer=function tokenizer(e,r){const o=e.css.valueOf(),n=new Reader(o),i={onParseError:(null==r?void 0:r.onParseError)??(()=>{})};return{nextToken:function nextToken(){if(n.resetRepresentation(),checkIfTwoCodePointsStartAComment(0,n)){if(null!=r&&r.commentsAreTokens)return consumeComment(i,n);consumeComment(i,n),n.resetRepresentation()}const e=n.codePointSource[n.cursor];if(void 0===e)return[exports.TokenType.EOF,"",-1,-1,void 0];if(isIdentStartCodePoint(e))return consumeIdentLikeToken(i,n);switch(e){case d:return n.readCodePoint(),[exports.TokenType.Comma,n.representationString(),n.representationStart,n.representationEnd,void 0];case a:return n.readCodePoint(),[exports.TokenType.Colon,n.representationString(),n.representationStart,n.representationEnd,void 0];case q:return n.readCodePoint(),[exports.TokenType.Semicolon,n.representationString(),n.representationStart,n.representationEnd,void 0];case g:return n.readCodePoint(),[exports.TokenType.OpenParen,n.representationString(),n.representationStart,n.representationEnd,void 0];case W:return n.readCodePoint(),[exports.TokenType.CloseParen,n.representationString(),n.representationStart,n.representationEnd,void 0];case A:return n.readCodePoint(),[exports.TokenType.OpenSquare,n.representationString(),n.representationStart,n.representationEnd,void 0];case F:return n.readCodePoint(),[exports.TokenType.CloseSquare,n.representationString(),n.representationStart,n.representationEnd,void 0];case k:return n.readCodePoint(),[exports.TokenType.OpenCurly,n.representationString(),n.representationStart,n.representationEnd,void 0];case R:return n.readCodePoint(),[exports.TokenType.CloseCurly,n.representationString(),n.representationStart,n.representationEnd,void 0];case t:case b:return consumeStringToken(i,n);case U:return consumeHashToken(i,n);case w:case P:return checkIfThreeCodePointsWouldStartANumber(0,n)?consumeNumericToken(i,n):(n.readCodePoint(),[exports.TokenType.Delim,n.representationString(),n.representationStart,n.representationEnd,{value:String.fromCharCode(e)}]);case M:case z:case K:case J:case Q:case Z:case _:case j:case G:case X:return consumeNumericToken(i,n);case x:case s:case S:case c:case H:return consumeWhiteSpace(0,n);case T:return checkIfThreeCodePointsWouldStartANumber(0,n)?consumeNumericToken(i,n):checkIfThreeCodePointsWouldStartCDC(0,n)?(n.readCodePoint(3),[exports.TokenType.CDC,n.representationString(),n.representationStart,n.representationEnd,void 0]):checkIfThreeCodePointsWouldStartAnIdentSequence(0,n)?consumeIdentLikeToken(i,n):(n.readCodePoint(),[exports.TokenType.Delim,n.representationString(),n.representationStart,n.representationEnd,{value:"-"}]);case E:return checkIfFourCodePointsWouldStartCDO(0,n)?(n.readCodePoint(4),[exports.TokenType.CDO,n.representationString(),n.representationStart,n.representationEnd,void 0]):(n.readCodePoint(),[exports.TokenType.Delim,n.representationString(),n.representationStart,n.representationEnd,{value:"<"}]);case u:if(n.readCodePoint(),checkIfThreeCodePointsWouldStartAnIdentSequence(0,n)){const e=consumeIdentSequence(i,n);return[exports.TokenType.AtKeyword,n.representationString(),n.representationStart,n.representationEnd,{value:String.fromCharCode(...e)}]}return[exports.TokenType.Delim,n.representationString(),n.representationStart,n.representationEnd,{value:"@"}];case N:return checkIfTwoCodePointsAreAValidEscape(0,n)?consumeIdentLikeToken(i,n):(n.readCodePoint(),i.onParseError({message:'Invalid escape sequence after "\\"',start:n.representationStart,end:n.representationEnd,state:["4.3.1. Consume a token","U+005C REVERSE SOLIDUS (\\)","The input stream does not start with a valid escape sequence"]}),[exports.TokenType.Delim,n.representationString(),n.representationStart,n.representationEnd,{value:"\\"}])}return n.readCodePoint(),[exports.TokenType.Delim,n.representationString(),n.representationStart,n.representationEnd,{value:String.fromCharCode(e)}]},endOfFile:function endOfFile(){return void 0===n.codePointSource[n.cursor]}}};
